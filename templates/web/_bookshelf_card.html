<div class="col">
  <div class="card book-card h-100">
    <div class="card-body p-2">
      <div class="d-flex gap-2">

        {% if show_covers %}
        <div class="flex-shrink-0">
          {% if item.cover %}
          <img src="/opds/thumb/{{ item.id }}/" alt="" class="book-cover-compact rounded cover-preview" data-cover-url="/opds/cover/{{ item.id }}/">
          {% else %}
          <img src="/static/images/nocover.svg" alt="" class="book-cover-compact rounded">
          {% endif %}
        </div>
        {% endif %}

        <div class="flex-grow-1 min-width-0">
          <div class="fw-semibold small text-truncate" title="{{ item.title }}"><a href="/web/search/books?type=i&q={{ item.id }}" class="text-decoration-none">{{ item.title }}</a></div>

          {% if item.authors | length > 0 %}
          <div class="small text-body-secondary text-truncate">
            {% for author in item.authors %}
              <a href="/web/search/books?type=a&q={{ author.id }}" class="text-decoration-none text-body-secondary">{{ author.full_name }}</a>{% if not loop.last %}, {% endif %}
            {% endfor %}
          </div>
          {% endif %}

          <div class="small text-body-secondary mt-1">
            <span class="badge text-bg-secondary">{{ item.format }}</span>
            {{ item.size | filesizeformat }}
            {% if item.read_time and item.read_time != "" %}
            Â· <time class="utc-time" datetime="{{ item.read_time }}">{{ item.read_time }}</time>
            {% endif %}
          </div>

          {% if item.has_read_progress %}
          {% set read_pct = item.read_progress_pct %}
          <div class="read-progress read-progress--compact mt-1">
            <span class="badge text-bg-success">{{ read_pct }}% {{ reader_read_badge }}</span>
            <div class="progress mt-1" role="progressbar"
                 aria-label="{{ reader_read_badge }}"
                 aria-valuenow="{{ read_pct }}" aria-valuemin="0" aria-valuemax="100"
                 style="height: 4px;">
              <div class="progress-bar bg-success" style="width: {{ read_pct }}%;"></div>
            </div>
          </div>
          {% endif %}

          <div class="book-actions mt-1">
            <a href="/web/download/{{ item.id }}/0" class="btn btn-primary btn-sm py-0 px-1">
              <i class="bi bi-download"></i> {{ item.format }}
            </a>
            {% if item.show_zip %}
            <a href="/web/download/{{ item.id }}/1" class="btn btn-outline-primary btn-sm py-0 px-1">zip</a>
            {% endif %}
            {% if reader_enabled and (item.format == "epub" or item.format == "fb2" or item.format == "mobi" or item.format == "djvu" or item.format == "pdf") %}
            <a href="/web/reader/{{ item.id }}" target="_blank" class="btn btn-sm btn-outline-success py-0 px-1" title="{{ t.book.read }}">
              <i class="bi bi-book-half"></i>
            </a>
            {% endif %}
            <form method="post" action="/web/bookshelf/toggle" class="bookshelf-action-form">
              <input type="hidden" name="book_id" value="{{ item.id }}">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
              <input type="hidden" name="redirect" value="/web/bookshelf">
              <button type="submit" class="btn btn-sm btn-warning bookshelf-toggle-btn py-0 px-1" title="{{ t.bookshelf.remove }}">
                <i class="bi bi-star-fill"></i>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
